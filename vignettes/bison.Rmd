---
title: "Bison Pool hot spring (2011, 2013)"
output: 
  rmarkdown::html_vignette:
    mathjax: null
vignette: >
  %\VignetteIndexEntry{Bison Pool hot spring (2011, 2013)}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
bibliography: JMDplots.bib
csl: elementa.csl
---

<style>
/* https://gomakethings.com/how-to-break-an-image-out-of-its-parent-container-with-css/ */
@media (min-width: 700px) {
  .full-width {
    left: 50%;
    margin-left: -50vw;
    margin-right: -50vw;
    max-width: 100vw;
    position: relative;
    right: 50%;
    width: 100vw;
  }
}
@media (min-width: 1020px) {
  .full-width {
    left: 50vw; /* fallback if needed */
    left: calc(50vw - 160px);
    width: 1000px;
    position: relative;
    background-color: #9ecff7;
    padding:10px;
  }
}
</style>

```{r setup, include=FALSE}
library(knitr)
## use pngquant to reduce size of PNG images
knit_hooks$set(pngquant = hook_pngquant)
pngquant <- "--speed=1 --quality=0-25"
# in case pngquant isn't available
if (!nzchar(Sys.which("pngquant"))) pngquant <- NULL 
```

```{r HTML, include=FALSE}
## some frequently used HTML expressions
ZC <- "<i>Z</i><sub>C</sub>"
```

This vignette from the R package [JMDplots](https://github.com/jedick/JMDplots) version `r packageDescription("JMDplots")$Version` contains plots from the papers by Dick and Shock (<a href="https://doi.org/10.1371/journal.pone.0022782" title="Calculation of the relative chemical stabilities of proteins as a function of temperature and redox chemistry in a hot spring">2011</a> and <a href="https://doi.org/10.1371/journal.pone.0072395" title="A metastable equilibrium model for the relative abundances of microbial phyla in a hot spring">2013</a>).

```{r JMDplots, message = FALSE, results = "hide"}
library(JMDplots)
```

The current OBIGT database in CHNOSZ has updates for the methionine sidechain group from @LD12 and the glycine group and protein backbone [UPBB] from @Kit14.
In order to reproduce the calculations from the 2011 paper, we load the old values from @DLH06.

```{r add.OBIGT, message = FALSE, results = "hide"}
add.OBIGT("OldAA")
```

## Measured temperature and pH
```{r bison1, message = FALSE, fig.align='center', out.width='100%', fig.width = 6, fig.height = 3, pngquant = pngquant}
bison1()
```
[Link to original figure](https://doi.org/10.1371/journal.pone.0022782.g005).
The lines are spline fits that represent smooth changes in *T* and pH that are used for some plots below.

## Carbon oxidation state of proteins
```{r bison2, message = FALSE, out.width='100%', fig.width = 13, fig.height = 6.5, out.extra='class="full-width"', pngquant = pngquant}
bison2()
```

Link to original figures: [functional annotations](https://doi.org/10.1371/journal.pone.0022782.g004) and [major phyla](https://doi.org/10.1371/journal.pone.0072395.g001).

## Chemical affinities 
```{r bison3, message = FALSE, results = "as.is"}
tab <- round(bison3(), 3)
htmltab <- capture.output(kable(tab, format = "html"))
# make selected values bold
for(i in c(15, 16, 41, 42, 43)) {
  htmltab[i] <- gsub('">', '"><b>', htmltab[i], fixed = TRUE)
  htmltab[i] <- gsub('</', '</b></', htmltab[i], fixed = TRUE)
}
structure(htmltab, format = "html", class = "knitr_kable")
```
[Link to original table](https://doi.org/10.1371/journal.pone.0022782.t005).
These per-residue affinities are expressed as dimensionless values, i.e. *A*/(2.303*RT*) where *A*, *R* and *T* stand for chemical affinity, gas constant, and temperature in Kelvin.
The affinities are all negative, but are higher (more positive) for the reaction to form model protein 1 at sites 1 and 2 and to form model protein 4 at sites 3--5.

## Relative stabilities along a temperature and chemical gradient
```{r bison4, message = FALSE, fig.align='center', out.width='100%', fig.width = 6, fig.height = 3, pngquant = pngquant}
bison4()
```
[Link to original figure](https://doi.org/10.1371/journal.pone.0022782.g005).
The first plot is a theoretical predominance diagram for the overall model proteins from each site as a function of temperature and activity of hydrogen.
The dotted line is placed so that it passes through the stability fields of the proteins at approximately the actual temperatures where they are located in the hot spring.
The second plot shows the effect of changing both temperature and pH (interpolated from measured values) together with log*a*~H2~ (from the line in the first plot) on the predicted relative abundances of the proteins in metastable equilibrium.

## Comparing old and new group additivity parameters
```{r bison5, message = FALSE, fig.align='center', out.width='100%', fig.width = 6, fig.height = 4, pngquant = pngquant}
bison5()
```
[Link to original figure](https://doi.org/10.1371/journal.pone.0072395.g002).
The first row of plots is made using group additivity parameters from @DLH06; the second is made with updates for the methionine sidechain from @LD12 and the glycine sidechain and protein backbone group from @Kit14.
Note the appearance of a stability field for the model proteins from site 3.
The remaining figures in this vignette use the updated parameters (i.e. the default values in OBIGT).

## References
